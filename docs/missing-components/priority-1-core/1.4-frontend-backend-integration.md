# Story 1.4: Frontend-Backend Integration

**Status**: ✅ Completed  
**Priority**: Critical  
**Estimated Effort**: 3-4 days  
**Dependencies**: 1.1 Authentication, 1.2 Core APIs, 1.3 Basic Matching

## Objective
Connect the existing Next.js frontend with the implemented backend APIs, replacing mock data with real API calls and establishing proper authentication flow.

## Current State
- ✅ Frontend components and pages exist
- ✅ Backend APIs are implemented (after 1.1-1.3)
- ❌ Frontend likely uses mock/placeholder data
- ❌ Authentication flow not connected to backend
- ❌ API service layer needs real endpoints
- ❌ Error handling between frontend/backend missing

## Acceptance Criteria
- [x] Users can register/login through frontend forms
- [x] JWT tokens are stored and managed properly
- [x] All frontend pages display real backend data
- [x] Error handling works across frontend/backend
- [x] Protected routes enforce authentication
- [x] Real-time data updates work correctly
- [x] Form submissions connect to backend APIs

## Technical Tasks

### Task 1: API Service Layer Setup
- [x] Update `frontend/src/services/api.ts` with real endpoints
- [x] Implement authentication service with JWT handling
- [x] Create user service for profile management
- [x] Create job service for job operations
- [x] Create application service for job applications
- [x] Add matching service for recommendations

### Task 2: Authentication Flow Integration
- [x] Connect login/register forms to backend
- [x] Implement JWT token storage (localStorage/cookies)
- [x] Add token refresh logic
- [x] Update auth context with real authentication
- [x] Add protected route guards
- [x] Handle authentication errors

### Task 3: Data Fetching Integration
- [x] Replace mock data in all components
- [x] Connect user profiles to backend
- [x] Connect job listings to backend API
- [x] Connect applications to backend workflow  
- [x] Connect matching results to algorithm
- [x] Add loading states and error handling

### Task 4: Forms and State Management
- [x] Connect all forms to backend endpoints
- [x] Add proper form validation
- [x] Handle API errors in form submissions
- [x] Update global state with real data
- [x] Add optimistic updates for better UX

### Task 5: Error Handling and UX
- [x] Standardize error display across app
- [x] Add proper loading indicators
- [x] Handle network connectivity issues
- [x] Add retry mechanisms for failed requests
- [x] Implement proper success notifications

## Implementation Files to Update
```
frontend/src/
├── services/
│   ├── api.ts                        # UPDATE (real endpoints)
│   ├── authService.ts                # UPDATE (JWT handling)
│   ├── userService.ts                # UPDATE (profile APIs)
│   ├── jobService.ts                 # UPDATE (job APIs)
│   ├── applicationService.ts         # UPDATE (application APIs)
│   └── matchingService.ts            # UPDATE (matching APIs)
├── hooks/
│   ├── useAuth.ts                    # UPDATE (real auth state)
│   ├── useApi.ts                     # NEW (API hook wrapper)
│   └── useError.ts                   # NEW (error handling)
├── context/
│   └── AuthContext.tsx               # UPDATE (real auth)
├── components/
│   ├── auth/
│   │   ├── LoginForm.tsx             # UPDATE (connect API)
│   │   └── RegisterForm.tsx          # UPDATE (connect API)
│   └── common/
│       ├── ErrorBoundary.tsx         # UPDATE (API errors)
│       └── LoadingSpinner.tsx        # UPDATE (API loading)
└── utils/
    ├── apiClient.ts                  # NEW (axios config)
    ├── tokenManager.ts               # NEW (JWT management)
    └── errorHandler.ts               # NEW (error utils)
```

## API Integration Configuration
```typescript
// API Base Configuration
const API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8080/api/v1';

// JWT Token Management
const tokenManager = {
  getToken: () => localStorage.getItem('access_token'),
  setToken: (token: string) => localStorage.setItem('access_token', token),
  removeToken: () => localStorage.removeItem('access_token')
};

// Axios Interceptors for JWT
axios.interceptors.request.use((config) => {
  const token = tokenManager.getToken();
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});
```

## Authentication Flow
```typescript
// Login Flow
1. User submits login form
2. Frontend calls POST /api/v1/auth/login
3. Backend validates credentials
4. Backend returns JWT tokens
5. Frontend stores tokens
6. Frontend redirects to dashboard
7. Protected routes check token validity

// Token Refresh Flow  
1. API request receives 401 Unauthorized
2. Frontend attempts token refresh
3. If refresh succeeds, retry original request
4. If refresh fails, redirect to login
```

## Testing Checklist
- [ ] Test authentication flow end-to-end
- [ ] Test all CRUD operations through frontend
- [ ] Test error handling scenarios
- [ ] Test loading states and user feedback
- [ ] Test token refresh functionality
- [ ] Test protected route authorization
- [ ] Test form validations with backend errors
- [ ] Cross-browser compatibility testing

## Error Handling Strategy
```typescript
// API Error Types
interface APIError {
  message: string;
  field?: string;
  code?: string;
}

// Error Display Component
const ErrorDisplay = ({ error }: { error: APIError }) => (
  <div className="error-message">
    {error.field ? `${error.field}: ${error.message}` : error.message}
  </div>
);
```

## Performance Considerations
- [ ] Implement request debouncing for search
- [ ] Add caching for frequently accessed data
- [ ] Optimize bundle size with code splitting
- [ ] Implement pagination for large lists
- [ ] Add image optimization for profiles/jobs
- [ ] Monitor and optimize API call frequency

## Definition of Done
- Users can complete full registration/login flow
- All pages display real data from backend
- Forms submit successfully to backend APIs
- Authentication persists across browser sessions
- Error messages are clear and helpful
- Loading states provide good user feedback
- Protected routes work correctly
- No mock data remains in production code

## Next Story Dependencies
- This story completes: Core platform functionality (Priority 1)
- This story enables: All Priority 2 business features
- This story is required for: User acceptance testing